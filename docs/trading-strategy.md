# 📊 交易策略详解

> 本文档详细说明本项目采用的交易策略、技术指标体系和决策逻辑

---

## 目录

- [核心交易理念](#核心交易理念)
- [技术指标体系](#技术指标体系)
- [综合评分系统](#综合评分系统)
- [AI决策仪表盘](#ai决策仪表盘)
- [风险控制](#风险控制)
- [策略优劣分析](#策略优劣分析)
- [使用建议](#使用建议)

---

## 核心交易理念

本项目采用**严格的趋势跟踪策略**，核心理念是"严进策略 + 趋势交易 + 效率优先"。

### 1. 严进策略 - 不追高原则

**核心指标：乖离率**

```
乖离率 = (现价 - MA5) / MA5 × 100%
```

**操作标准：**

| 乖离率范围 | 操作建议 | 说明 |
|-----------|---------|------|
| < 2% | ✅ 最佳买点 | 价格贴近MA5，介入好时机 |
| 2% - 5% | ⚡ 可小仓介入 | 价格略高，可谨慎介入 |
| > 5% | ❌ 严禁追高 | 直接判定为"观望"，等待回调 |

**代码实现位置：** `src/stock_analyzer.py:183-187`

**设计理念：**
- 避免追高，提高每笔交易成功率
- 5%是硬性阈值，超过直接扣分至4分（满分20分）
- 宁可错过，不可做错

---

### 2. 趋势交易 - 多头排列必须条件

**核心判断标准：MA5 > MA10 > MA20**

#### 趋势分级系统

| 趋势状态 | 判断条件 | 趋势强度 | 说明 |
|---------|---------|---------|------|
| **强势多头** | MA5>MA10>MA20 且间距扩大 | 90分 | 均线发散上行，最强趋势 |
| **多头排列** | MA5>MA10>MA20 | 75分 | 标准多头排列 |
| **弱势多头** | MA5>MA10 但 MA10≤MA20 | 55分 | 趋势转强初期 |
| **盘整** | 均线缠绕 | 50分 | 趋势不明，观望 |
| **弱势空头** | MA5<MA10 但 MA10≥MA20 | 40分 | 趋势转弱初期 |
| **空头排列** | MA5<MA10<MA20 | 25分 | 标准空头排列 |
| **强势空头** | MA5<MA10<MA20 且间距扩大 | 10分 | 均线发散下行，最弱趋势 |

**代码实现位置：** `src/stock_analyzer.py:338-389`

**设计理念：**
- 只做多头排列的股票，空头排列坚决不碰
- 均线发散上行优于均线粘合
- 趋势强度判断：看均线间距是否在扩大

---

### 3. 效率优先 - 筹码结构分析

关注筹码集中度和获利比例，寻找主力控盘的股票。

#### 筹码健康标准

| 指标 | 健康标准 | 说明 |
|-----|---------|------|
| **90%筹码集中度** | < 15% | 筹码集中，主力控盘 |
| **获利比例** | 70-90%时警惕 | 警惕获利回吐压力 |
| **现价 vs 平均成本** | 高于5-15% | 健康的获利空间 |

**代码实现位置：** `src/core/pipeline.py:185-194`

**设计理念：**
- 筹码集中度高的股票，主力拉升更容易
- 获利比例过高时，需警惕获利回吐
- 平均成本是重要的支撑位参考

---

### 4. 买点偏好 - 回踩支撑策略

**最佳买点识别：**

| 买点类型 | 判断条件 | 评分加成 | 说明 |
|---------|---------|---------|------|
| **最佳买点** | 缩量回踩MA5获得支撑 | +5分 | 洗盘特征明显 |
| **次优买点** | 回踩MA10获得支撑 | +5分 | 中短期支撑有效 |
| **观望情况** | 跌破MA20 | 0分 | 趋势可能破坏 |

**支撑判断容忍度：2%**

**代码实现位置：** `src/stock_analyzer.py:446-477`

**设计理念：**
- 偏好缩量回调，表示抛压减轻
- 回踩均线获得支撑是最佳介入时机
- MA20是重要的中期支撑位

---

## 技术指标体系

### 1. MACD 指标

**参数配置：**
- 快线（DIF）：EMA(12)
- 慢线（DEA）：EMA(26)
- 信号线（MACD）：EMA(9)

**计算公式：**
```
DIF = EMA(12) - EMA(26)
DEA = EMA(DIF, 9)
MACD = (DIF - DEA) × 2
```

#### 信号分级

| 信号类型 | 判断条件 | 评分 | 说明 |
|---------|---------|-----|------|
| **⭐ 零轴上金叉** | DIF上穿DEA 且在零轴上方 | 15分 | 最强买入信号 |
| **✅ 金叉** | DIF上穿DEA | 12分 | 趋势向上 |
| **⚡ 上穿零轴** | DIF上穿零轴 | 10分 | 趋势转强 |
| **✓ 多头排列** | DIF>0 且 DEA>0 | 8分 | 持续上涨 |
| **⚠ 空头排列** | DIF<0 且 DEA<0 | 2分 | 持续下跌 |
| **⚠️ 下穿零轴** | DIF下穿零轴 | 0分 | 趋势转弱 |
| **❌ 死叉** | DIF下穿DEA | 0分 | 趋势向下 |

**代码实现位置：** `src/stock_analyzer.py:275-301, 479-540`

---

### 2. RSI 指标

**参数配置：**
- RSI(6)：短期
- RSI(12)：中期（主要判断依据）
- RSI(24)：长期

**计算公式：**
```
RS = 平均上涨幅度 / 平均下跌幅度
RSI = 100 - (100 / (1 + RS))
```

#### 状态判断

| RSI范围 | 状态 | 评分 | 操作建议 |
|--------|-----|-----|---------|
| > 70 | ⚠️ 超买 | 0分 | 谨慎追高，短期回调风险高 |
| 60-70 | ✅ 强势 | 8分 | 多头力量充足 |
| 40-60 | 中性 | 5分 | 震荡整理中 |
| 30-40 | ⚡ 弱势 | 3分 | 关注反弹机会 |
| < 30 | ⭐ 超卖 | 10分 | 反弹机会大 |

**代码实现位置：** `src/stock_analyzer.py:303-336, 542-580`

---

### 3. 量能分析

**量比计算：**
```
量比 = 当日成交量 / 5日平均成交量
```

#### 量能状态判断

| 量能状态 | 判断条件 | 评分 | 说明 |
|---------|---------|-----|------|
| **✅ 缩量回调** | 量比≤0.7 且价格下跌 | 15分 | 主力洗盘特征（最佳） |
| **✅ 放量上涨** | 量比≥1.5 且价格上涨 | 12分 | 多头力量强劲 |
| **正常** | 0.7<量比<1.5 | 10分 | 量能正常 |
| **⚠️ 缩量上涨** | 量比≤0.7 且价格上涨 | 6分 | 上攻动能不足 |
| **❌ 放量下跌** | 量比≥1.5 且价格下跌 | 0分 | 注意风险 |

**代码实现位置：** `src/stock_analyzer.py:408-444`

**设计理念：**
- 缩量回调是最佳买点特征，表示抛压减轻
- 放量上涨次之，表示多头力量强劲
- 放量下跌最差，表示主力出货

---

## 综合评分系统

### 市场环境过滤（新增）

在个股评分基础上，系统会先分析大盘趋势，根据市场环境动态调整买入门槛。

#### 市场环境判断

**判断维度（100分制）：**

| 维度 | 权重 | 说明 |
|-----|------|------|
| **趋势状态** | 40分 | 基于上证指数MA5/MA10/MA20判断 |
| **涨跌比** | 30分 | 上涨家数/下跌家数 |
| **涨停数** | 15分 | 反映市场热度 |
| **成交额** | 15分 | 反映市场活跃度 |

**市场趋势分级：**

| 市场状态 | 判断条件 | 趋势强度 |
|---------|---------|---------|
| **强势牛市** | 上证MA5>MA10>MA20 且间距扩大 | 90分 |
| **牛市** | 上证MA5>MA10>MA20 | 75分 |
| **弱势牛市** | 上证MA5>MA10 但 MA10≤MA20 | 55分 |
| **震荡市** | 均线缠绕 | 50分 |
| **弱势熊市** | 上证MA5<MA10 但 MA10≥MA20 | 40分 |
| **熊市** | 上证MA5<MA10<MA20 | 25分 |
| **强势熊市** | 上证MA5<MA10<MA20 且间距扩大 | 10分 |

---

#### 动态调整策略

根据市场环境评分，系统会自动调整个股买入标准：

| 市场评分 | 市场状态 | 个股评分调整 | 乖离率阈值调整 | 仓位建议 |
|---------|---------|------------|--------------|---------|
| ≥75分 | 强势牛市 | +15分 | +2% (放宽至7%) | 70-90% |
| 60-75分 | 牛市 | +10分 | +1% (放宽至6%) | 60-80% |
| 50-60分 | 弱势牛市/震荡 | 0分 | 0% (保持5%) | 40-60% |
| 40-50分 | 弱势熊市 | -10分 | -1% (收紧至4%) | 20-40% |
| <40分 | 熊市/强势熊市 | -15分 | -2% (收紧至3%) | 0-20% |

**代码实现位置：** `src/market_filter.py`

**设计理念：**
- **强市降低门槛**：牛市中适当放宽标准，避免错过机会
- **弱市提高门槛**：熊市中严格筛选，只做最优质标的
- **动态乖离率**：根据市场环境调整追高容忍度
- **仓位管理**：市场环境直接影响建议仓位

**示例：**
```
市场环境：牛市（评分65）
个股原始评分：60分
调整后评分：60 + 10 = 70分 ✅ 通过（买入门槛60分）
乖离率阈值：5% → 6%（可适当追高）
仓位建议：60-80%
```

```
市场环境：弱势熊市（评分45）
个股原始评分：60分
调整后评分：60 - 10 = 50分 ❌ 未通过（买入门槛60分）
乖离率阈值：5% → 4%（严禁追高）
仓位建议：20-40%
```

---

### 100分制评分体系

| 维度 | 权重 | 评分标准 | 代码位置 |
|-----|------|---------|---------|
| **趋势** | 30分 | 强势多头30分，多头26分，弱势多头18分，盘整12分，空头0-8分 | 598-614行 |
| **乖离率** | 20分 | <0%且>-3%得20分，0-2%得18分，2-5%得14分，>5%得4分 | 617-637行 |
| **量能** | 15分 | 缩量回调15分，放量上涨12分，正常10分，缩量上涨6分，放量下跌0分 | 640-653行 |
| **MACD** | 15分 | 零轴上金叉15分，金叉12分，上穿零轴10分，多头8分，空头2分，死叉0分 | 664-681行 |
| **支撑** | 10分 | MA5支撑5分，MA10支撑5分 | 656-661行 |
| **RSI** | 10分 | 超卖10分，强势8分，中性5分，弱势3分，超买0分 | 684-699行 |

**总分：100分**

### 操作信号生成

| 评分范围 | 趋势条件 | 操作信号 | 说明 |
|---------|---------|---------|------|
| ≥75分 | 强势多头/多头排列 | 💚 强烈买入 | 多条件满足，最佳买点 |
| ≥60分 | 多头/弱势多头 | 🟢 买入 | 基本条件满足 |
| ≥45分 | 任意 | 🟡 持有 | 已持有可继续 |
| ≥30分 | 任意 | ⚪ 观望 | 等待更好时机 |
| <30分 | 空头排列 | 🔴 卖出/强烈卖出 | 趋势破坏 |

**代码实现位置：** `src/stock_analyzer.py:582-718`

---

## AI决策仪表盘

项目使用 **Google Gemini AI** 生成专业的决策仪表盘，结合技术面、基本面和舆情面进行综合分析。

### 仪表盘结构

#### 1. 核心结论

```json
{
  "one_sentence": "一句话核心结论（30字以内）",
  "signal_type": "🟢买入信号/🟡持有观望/🔴卖出信号/⚠️风险警告",
  "time_sensitivity": "立即行动/今日内/本周内/不急",
  "position_advice": {
    "no_position": "空仓者建议：具体操作指引",
    "has_position": "持仓者建议：具体操作指引"
  }
}
```

**特点：**
- 一句话说清该买/该卖/该等
- 分持仓建议：空仓者 vs 持仓者
- 时间敏感度：明确操作时间窗口

---

#### 2. 数据透视

**趋势状态：**
- 均线排列状态描述
- 是否多头排列（布尔值）
- 趋势评分（0-100）

**价格位置：**
- 当前价、MA5、MA10、MA20
- 乖离率（百分比）
- 乖离状态：安全/警戒/危险
- 支撑位、压力位

**量能分析：**
- 量比数值
- 量能状态：放量/缩量/平量
- 换手率
- 量能含义解读

**筹码结构：**
- 获利比例
- 平均成本
- 筹码集中度
- 筹码健康度：健康/一般/警惕

---

#### 3. 舆情情报

**最新消息：**
- 近期重要新闻摘要
- 公告信息

**风险警报：**
- 减持公告
- 监管处罚
- 业绩预亏
- 行业利空

**利好催化：**
- 业绩增长
- 重大合同
- 政策利好

**业绩预期：**
- 年报预告
- 业绩快报
- 机构预测

---

#### 4. 作战计划

**狙击点位：**
```
理想买入点：XX元（在MA5附近）
次优买入点：XX元（在MA10附近）
止损位：XX元（跌破MA20或X%）
目标位：XX元（前高/整数关口）
```

**仓位策略：**
- 建议仓位：X成
- 分批建仓策略
- 风控策略

**检查清单：**
```
✅ 多头排列
✅ 乖离率<5%
✅ 量能配合
⚠️ 无重大利空
✅ 筹码健康
```

**代码实现位置：** `src/analyzer.py:249-421`

---

## 风险控制

### 风险排查重点

AI 分析时会重点排查以下风险：

1. **减持公告**
   - 股东减持
   - 高管减持
   - 大宗交易

2. **业绩风险**
   - 业绩预亏
   - 业绩大幅下滑
   - 商誉减值

3. **监管风险**
   - 监管处罚
   - 立案调查
   - 违规事项

4. **行业风险**
   - 政策利空
   - 行业周期下行
   - 竞争加剧

5. **解禁风险**
   - 大额解禁
   - 解禁时间
   - 解禁比例

**代码实现位置：** `src/analyzer.py:276-281`

---

### 止损策略

**止损位设置原则：**

1. **技术止损**
   - 跌破MA20：趋势可能破坏
   - 跌破前低：支撑失效
   - 跌幅超过5-8%：硬性止损

2. **时间止损**
   - 持仓超过2周未盈利：考虑止损
   - 长期横盘：资金效率低

3. **基本面止损**
   - 重大利空出现：立即止损
   - 业绩变脸：果断离场

---

## 策略优劣分析

### ✅ 优势

1. **严格的风控**
   - 5%乖离率硬性限制，避免追高
   - 明确的止损位设置
   - 风险优先原则

2. **趋势确认**
   - 多重指标验证（MA+MACD+RSI）
   - 趋势分级系统
   - 避免假突破

3. **量价配合**
   - 偏好缩量回调
   - 避免放量下跌
   - 量能状态细分

4. **精确点位**
   - 给出具体买入价
   - 明确止损价
   - 清晰目标价

5. **AI 辅助**
   - 结合新闻舆情
   - 基本面分析
   - 风险排查

---

### ⚠️ 局限性

1. **滞后性**
   - 均线系统天然滞后
   - 可能错过快速启动
   - 趋势确认需要时间

2. **震荡市不利**
   - 横盘震荡信号频繁
   - 假突破较多
   - 容易被反复打止损

3. **依赖趋势**
   - 只适合趋势明显的市场
   - 弱市中机会较少
   - 需要大盘配合

4. **不适合短线**
   - 更适合中短期持有（1-2周）
   - 日内交易效果差
   - 需要一定的持仓耐心

---

### 🎯 适用场景

**最佳场景：**
- ✅ 趋势明显的牛市
- ✅ 多头排列的个股
- ✅ 中短期交易（1-2周）
- ✅ 风险厌恶型投资者

**不适合场景：**
- ❌ 横盘震荡市
- ❌ 快速反转行情
- ❌ 超短线交易
- ❌ 高频交易

---

## 使用建议

### 💡 参数优化建议

1. **乖离率阈值调整**
   - 牛市：可放宽至7%
   - 熊市：收紧至3%
   - 震荡市：保持5%

2. **均线周期调整**
   - 短线：MA3/MA6/MA12
   - 中线：MA5/MA10/MA20（默认）
   - 长线：MA10/MA20/MA60

3. **评分权重调整**
   - 趋势市：提高趋势权重至40%
   - 震荡市：提高量能权重至20%
   - 弱市：提高风险排查权重

---

### 🔧 策略增强建议

1. **加入波动率指标**
   - 增加 ATR（真实波动幅度）
   - 动态调整止损位
   - 根据波动率调整仓位

2. **仓位管理优化**
   - 根据信号强度（评分）动态调整仓位
   - 75分以上：满仓
   - 60-75分：半仓
   - 45-60分：轻仓

3. **回测验证**
   - 对历史数据进行回测
   - 优化评分权重
   - 验证策略有效性

4. **多周期分析**
   - 增加日线、周线、月线多周期共振
   - 提高信号可靠性

---

### 📊 实战建议

1. **严格执行纪律**
   - 不追高（乖离率>5%坚决不买）
   - 不抄底（空头排列不碰）
   - 不重仓（单股不超过30%）

2. **分批建仓**
   - 首次买入：30%仓位
   - 确认支撑：加仓30%
   - 突破前高：加仓40%

3. **及时止盈止损**
   - 达到目标位：分批止盈
   - 跌破MA20：果断止损
   - 重大利空：立即离场

4. **定期复盘**
   - 每周复盘持仓
   - 检查趋势是否破坏
   - 调整操作策略

---

## 总结

本项目采用的是一套**保守型趋势跟踪策略**，核心思想是**"宁可错过，不可做错"**。

**策略特点：**
- 严格的风控体系
- 多重指标验证
- AI 辅助决策
- 精确的点位指引

**适用人群：**
- 风险厌恶型投资者
- 中短期交易者
- 技术面为主的交易者
- 追求稳健收益的投资者

**核心理念：**
> 不追高、顺趋势、重风控、求稳健

---

## 附录

### 相关代码文件

- `main.py` - 主程序入口，交易理念说明
- `src/stock_analyzer.py` - 趋势分析器，核心策略实现
- `src/analyzer.py` - AI 分析器，决策仪表盘生成
- `src/core/pipeline.py` - 分析流水线，数据整合
- `src/notification.py` - 通知服务，报告生成

### 参考资料

- [完整配置指南](full-guide.md)
- [项目 README](../README.md)
- [贡献指南](CONTRIBUTING.md)

---

**免责声明：** 本策略仅供学习和研究使用，不构成任何投资建议。股市有风险，投资需谨慎。

**最后更新：** 2026-01-26
